import git
import re


def git_pull():
    repo = git.Repo('/Users/macbookpro/PycharmProjects/mts-cve-parser/cvelist')
    o = repo.remotes.origin
    return o.pull()


def git_add():
    repo = git.Repo('/Users/macbookpro/PycharmProjects/mts-cve-parser')
    return repo.git.add(all=True)


def git_commit():
    repo = git.Repo('/Users/macbookpro/PycharmProjects/mts-cve-parser')
    return repo.index.commit("Commit with GitPython")


def git_diff():
    repo = git.Repo("/Users/macbookpro/PycharmProjects/mts-cve-parser")
    diff_result = repo.git.diff("--submodule=diff", "HEAD^")

    r1 = set(re.findall(r"CVE-[0-9]+-[0-9]+.json", diff_result))

    return len(r1)

